name: Auto Commit

on:
  schedule:
    - cron: "0 9 * * *"   # 9:00 AM
    - cron: "0 21 * * *"  # 9:00 PM
    
  workflow_dispatch:  # Manual trigger

jobs:
  auto-commit:
    runs-on: ubuntu-latest
    permissions:
      contents: write
    steps:
      - name: Checkout repository
        uses: actions/checkout@v3
        
      - name: Configure git
        run: |
          git config --local user.email "vijendrasaini@startbitsolutions.com"
          git config --local user.name "Vijendra Kumar Saini"

      - name: Update demo file
        run: |
          echo "Last run: $(date)" >> demo_test.txt    
          
      - name: Check for changes
        id: verify-changed-files
        run: |
          if [ -n "$(git status --porcelain)" ]; then
            echo "changed=true" >> $GITHUB_OUTPUT
          else
            echo "changed=false" >> $GITHUB_OUTPUT
          fi
          
      - name: Commit and push changes
        if: steps.verify-changed-files.outputs.changed == 'true'
        run: |
          MESSAGES=("Daily Queue process" "Article Queue update" "Seo update" "Undo changes" "Clean code" "Process update" "New timestamp added" "Improve job scheduler" "Fix date parsing issue" "Optimize API response" "Log format update" "Add missing validations" "Refactor controller logic" "Update dependency versions" "Improve error handling" "Background job enhancement" "Add retry mechanism" "Fix broken UI links" "Update routing logic" "Remove unused functions" "Add new environment variables" "Improve caching logic" "New migration added" "Queue timeout update" "Improve response structure" "Audit logs updated" "Fix duplicate entries" "Refactor helper functions" "Improve test coverage" "Status update logic" "Add new config options" "Performance tuning" "Fix failing unit tests" "Role permission update" "New API integration" "Improve query performance" "Add fallback checks" "Refactor workflow steps" "File upload fix" "Token refresh update" "Add logs for debugging" "Improve pagination logic" "Regex validation update" "Remove obsolete code" "Update notification templates" "Add timezone support" "Import/export enhancement" "Add new feature flags" "Revise cleanup script" "Improve security checks")
          MSG=${MESSAGES[$RANDOM % ${#MESSAGES[@]}]}
          git add demo_test.txt
          git commit -m "$MSG: $(date)"
          git push
